(function(){"use strict";var e={9274:function(e,a,t){var o=t(5130),r=t(6768),n=(t(3110),t(8335),t(2261)),l=t(144),s=(t(4114),t(4373)),i=t(7694),c=t(1387);const d=18e5;let u=parseInt(sessionStorage.getItem("lastOperateTime")||`${Date.now()}`,10),p=null;const m=()=>{u=Date.now(),sessionStorage.setItem("lastOperateTime",`${u}`)},h=()=>{const e=Date.now();return e-u>d},f=()=>{p&&clearTimeout(p),p=setTimeout(g,d)},g=()=>{const e=na();e.loginUser.id&&(i.Ay.warning("登录状态已失效，请重新登录"),e.clearLoginUser(),sessionStorage.removeItem("lastOperateTime"),Ne.push({path:"/user/login",query:{redirect:encodeURIComponent(Ne.currentRoute.value.fullPath)}}))},y=()=>{const e=["click","keydown","scroll","mousemove"];e.forEach((e=>{window.addEventListener(e,(()=>{m(),f()}))})),window.addEventListener("beforeunload",(()=>{p&&clearTimeout(p),p=null}))};t(4603),t(7566),t(8721);var v=t(4232),b=t(1576),w=t.n(b),x=t(4079),k=t(2076);const L=(0,r.pM)({name:"ReportTable"});var A=(0,r.pM)({...L,props:{tabKey:{},columns:{},dataSource:{},paginationConfig:{},paginationParams:{}},emits:["download","regenerate"],setup(e,{emit:a}){const t=e,o=a,n=e=>{if(!e)return void o("regenerate",t.tabKey,"");const a=w()(e).format("YYYY-MM-DD")+" 09:00:01";o("regenerate",t.tabKey,a)},s=e=>{if(!e)return void o("download",t.tabKey,"");const a=w()(e).format("YYYY-MM-DD")+" 09:00:01";o("download",t.tabKey,a)};return(e,a)=>{const t=(0,r.g2)("a-button"),o=(0,r.g2)("a-table");return(0,r.uX)(),(0,r.Wv)(o,{columns:e.columns,"data-source":e.dataSource,bordered:"",pagination:e.paginationConfig,"row-key":e=>e.id},{bodyCell:(0,r.k6)((({column:o,record:i,index:c})=>["index"===o.key?((0,r.uX)(),(0,r.CE)(r.FK,{key:0},[(0,r.eW)((0,v.v_)((e.paginationParams.pageIndex-1)*e.paginationParams.pageSize+c+1),1)],64)):"reportedTime"===o.dataIndex?((0,r.uX)(),(0,r.CE)(r.FK,{key:1},[(0,r.eW)((0,v.v_)((0,l.R1)(w())(i.reportedTime).format("YYYY-MM-DD")),1)],64)):"createTime"===o.dataIndex?((0,r.uX)(),(0,r.CE)(r.FK,{key:2},[(0,r.eW)((0,v.v_)((0,l.R1)(w())(i.createdtime).format("YYYY-MM-DD HH:mm:ss")),1)],64)):"action"===o.key?((0,r.uX)(),(0,r.CE)(r.FK,{key:3},[(0,r.bF)(t,{onClick:e=>n(i.reportedTime)},{default:(0,r.k6)((()=>a[0]||(a[0]=[(0,r.eW)("重建")]))),_:2},1032,["onClick"]),(0,r.bF)(t,{onClick:e=>s(i.reportedTime)},{default:(0,r.k6)((()=>a[1]||(a[1]=[(0,r.eW)("下载")]))),_:2},1032,["onClick"])],64)):(0,r.Q3)("",!0)])),_:1},8,["columns","data-source","pagination","row-key"])}}}),S=t(1241);const F=(0,S.A)(A,[["__scopeId","data-v-6ef46102"]]);var _=F,C=t(8392),T=t(6011);t(4514);const R={id:"userManagePage"},E={class:"batch-download-container"},U={class:"batch-tips"};var I=(0,r.pM)({__name:"HomePage",setup(e){w().locale("zh-cn");const a=[{key:"1",tab:"日报表"},{key:"2",tab:"周报表"},{key:"3",tab:"月报表"},{key:"4",tab:"年报表"}],t=[{title:"序号",key:"index",width:80,align:"center"},{title:"报表日期",dataIndex:"reportedTime",key:"reportedTime"},{title:"创建时间",dataIndex:"createTime",key:"createTime"},{title:"操作",key:"action",width:120,align:"center"}],o=(0,l.KR)("1"),n=(0,l.KR)(!1),s=(0,l.Kh)({pageIndex:1,pageSize:10,total:0}),c=(0,l.Kh)({1:{list:[]},2:{list:[]},3:{list:[]},4:{list:[]}}),d=(0,l.KR)(""),u=(0,l.KR)(null),p=(0,l.KR)(!1),m=(0,l.KR)(!1),h=(0,r.EW)((()=>({current:s.pageIndex,pageSize:s.pageSize,total:s.total,pageSizeOptions:["10","20","50","100"],showSizeChanger:!0,showQuickJumper:!0,showTotal:e=>`共 ${e} 条记录`,onChange:(e,t)=>{s.pageIndex=e,s.pageSize=t,a.map((e=>e.key)).includes(o.value)&&z(o.value)},onShowSizeChange:(e,t)=>{s.pageIndex=1,s.pageSize=t,a.map((e=>e.key)).includes(o.value)&&z(o.value)}}))),f=e=>e?.isAfter(w()().endOf("month"))||!1,g=()=>d.value?!!u.value||(i.Ay.warning("请选择报表月份"),!1):(i.Ay.warning("请选择报表类型"),!1),y=(e,a,t)=>{const o={xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",zip:"application/zip"},r=new Blob([e.data],{type:o[t]}),n=e.headers?.["content-disposition"];let l=a;if(n){const e=n.match(/filename\*=UTF-8''([^;]+)/i);if(e?.[1])l=decodeURIComponent(e[1]);else{const e=n.match(/filename=([^;]+)/i);e?.[1]&&(l=decodeURIComponent(e[1].replace(/['"]/g,"")))}}const s=window.URL.createObjectURL(r),c=document.createElement("a");c.href=s,c.download=l,document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(s),i.Ay.success(("xlsx"===t?"报表":"ZIP包")+"下载成功")},b=async(e,a)=>{if(!a)return i.Ay.warning("ID 不能为空");try{const t=await ta(a,Number(e)),o=t.headers?.["content-disposition"];let r=`报表_${a.substring(0,10)}.xlsx`;if(o){const e=o.match(/filename\*=UTF-8''([^;]+)/i);if(e?.[1])r=decodeURIComponent(e[1]);else{const e=o.match(/filename=([^;]+)/i);e?.[1]&&(r=decodeURIComponent(e[1].replace(/['"]/g,"")))}}y(t,r,"xlsx")}catch(t){console.error("报表下载失败：",t),i.Ay.error("下载失败：网络异常或接口错误")}},L=async()=>{if(!g())return;const e=u.value.format("YYYY-MM-01"),a={type:Number(d.value),timeStr:e};try{p.value=!0;const e=await oa(a);y(e,`报表_${u.value.format("YYYYMM")}.zip`,"zip")}catch(t){console.error("批量下载ZIP失败：",t),i.Ay.error("批量下载失败：网络异常或接口错误")}finally{p.value=!1}},A=e=>{o.value=e,"5"!==e&&(s.pageIndex=1,z(e))},S=()=>{u.value=null},F=()=>{d.value="",u.value=null},I=async(e,a)=>{if(!e||!a)return i.Ay.warning("参数缺失，无法重新生成");try{m.value=!0;const t=a.replace(" ","T")+".000";await ra({type:Number(e),time:t}),i.Ay.success("已提交重新生成请求，任务完成后请下载或刷新查看")}catch(t){console.error("重新生成失败：",t),i.Ay.error("重新生成失败：网络异常或接口错误")}finally{m.value=!1}},z=async e=>{if(!n.value)try{n.value=!0;const a=await aa({pageIndex:s.pageIndex,pageSize:s.pageSize,Type:Number(e)});a.data?(c[e].list=a.data.data||[],s.total=a.data.totalCount||0):i.Ay.error(`获取${e}号表格数据失败`)}catch(a){console.error(`获取${e}号表格数据异常：`,a),i.Ay.error(`获取${e}号表格数据失败：网络异常`)}finally{n.value=!1}};return z("1"),(e,o)=>{const n=(0,r.g2)("a-tab-pane"),i=(0,r.g2)("a-select-option"),m=(0,r.g2)("a-select"),g=(0,r.g2)("a-form-item"),y=(0,r.g2)("a-date-picker"),w=(0,r.g2)("a-button"),z=(0,r.g2)("a-form"),Y=(0,r.g2)("a-tabs");return(0,r.uX)(),(0,r.CE)("div",R,[(0,r.bF)(Y,{"default-active-key":"1",type:"card",onChange:A},{default:(0,r.k6)((()=>[((0,r.uX)(),(0,r.CE)(r.FK,null,(0,r.pI)(a,(e=>(0,r.bF)(n,{key:e.key,tab:e.tab},{default:(0,r.k6)((()=>[(0,r.bF)(_,{"tab-key":e.key,columns:t,"data-source":c[e.key]?.list||[],"pagination-config":h.value,"pagination-params":s,onDownload:b,onRegenerate:I},null,8,["tab-key","data-source","pagination-config","pagination-params"])])),_:2},1032,["tab"]))),64)),(0,r.bF)(n,{tab:"批量下载报表",key:"5"},{default:(0,r.k6)((()=>[(0,r.Lk)("div",E,[o[5]||(o[5]=(0,r.Lk)("div",{class:"batch-download-header"},[(0,r.Lk)("h3",{class:"batch-download-title"},"批量报表下载"),(0,r.Lk)("p",{class:"batch-download-desc"}," 根据选择的报表类型和月份，下载对应月份的报表文件 ")],-1)),(0,r.bF)((0,l.R1)(C.Ay),{locale:(0,l.R1)(T.A)},{default:(0,r.k6)((()=>[(0,r.bF)(z,{class:"batch-download-form",layout:"vertical","label-col":{span:4},"wrapper-col":{span:20}},{default:(0,r.k6)((()=>[(0,r.bF)(g,{label:"报表类型","validate-status":d.value?"":"error",help:d.value?"":"请选择报表类型"},{default:(0,r.k6)((()=>[(0,r.bF)(m,{value:d.value,"onUpdate:value":o[0]||(o[0]=e=>d.value=e),style:{width:"100%","max-width":"300px"},placeholder:"请选择报表类型","allow-clear":"",onChange:S},{default:(0,r.k6)((()=>[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(a.filter((e=>"4"!==e.key)),(e=>((0,r.uX)(),(0,r.Wv)(i,{key:e.key,value:e.key},{default:(0,r.k6)((()=>[(0,r.eW)((0,v.v_)(e.tab),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])])),_:1},8,["validate-status","help"]),(0,r.bF)(g,{label:"选择月份","validate-status":!u.value&&d.value?"error":"",help:!u.value&&d.value?"请选择报表月份":""},{default:(0,r.k6)((()=>[(0,r.bF)(y,{value:u.value,"onUpdate:value":o[1]||(o[1]=e=>u.value=e),picker:"month",style:{width:"100%","max-width":"300px"},placeholder:"选择报表月份",format:"YYYY年MM月","allow-clear":"","disabled-date":f},null,8,["value"])])),_:1},8,["validate-status","help"]),(0,r.bF)(g,{"wrapper-col":{offset:4}},{default:(0,r.k6)((()=>[(0,r.bF)(w,{type:"primary",onClick:L,loading:p.value,class:"batch-download-btn"},{icon:(0,r.k6)((()=>[(0,r.bF)((0,l.R1)(x.A))])),default:(0,r.k6)((()=>[o[2]||(o[2]=(0,r.eW)(" 下载报表 "))])),_:1},8,["loading"]),(0,r.bF)(w,{onClick:F,style:{"margin-left":"12px"}},{default:(0,r.k6)((()=>o[3]||(o[3]=[(0,r.eW)(" 重置 ")]))),_:1}),(0,r.Lk)("div",U,[(0,r.bF)((0,l.R1)(k.A),{style:{"margin-right":"4px"}}),o[4]||(o[4]=(0,r.eW)(" 提示：下载所选月份的对应类型报表文件（默认按当月01日查询） "))])])),_:1})])),_:1})])),_:1},8,["locale"])])])),_:1})])),_:1})])}}});const z=(0,S.A)(I,[["__scopeId","data-v-719c8edc"]]);var Y=z;const P={id:"userManagePage"},K={key:0},W={key:1},D={key:0},M={key:1},O={key:2};var q=(0,r.pM)({__name:"UserManagePage",setup(e){const a=(0,l.KR)(""),t=async()=>{c(a.value)},o=async e=>{if(!e)return;const a=await ea(e);0===a.data.code?(c(),i.Ay.success("删除成功")):i.Ay.error("删除失败")},n=[{title:"id",dataIndex:"id"},{title:"用户名",dataIndex:"userName"},{title:"账号",dataIndex:"userAccount"},{title:"头像",dataIndex:"avatarUrl"},{title:"性别",dataIndex:"gender"},{title:"创建时间",dataIndex:"createTime"},{title:"用户角色",dataIndex:"userRole"},{title:"操作",key:"action"}],s=(0,l.KR)([]),c=async(e="")=>{const a=await Ze(e);a.data.data?s.value=a.data.data:i.Ay.error("获取数据失败")};return c(),(e,i)=>{const c=(0,r.g2)("a-input-search"),d=(0,r.g2)("a-image"),u=(0,r.g2)("a-tag"),p=(0,r.g2)("a-button"),m=(0,r.g2)("a-table");return(0,r.uX)(),(0,r.CE)("div",P,[(0,r.bF)(c,{style:{"max-width":"320px","margin-bottom":"20px"},value:a.value,"onUpdate:value":i[0]||(i[0]=e=>a.value=e),placeholder:"输入用户名搜索","enter-button":"搜索",size:"large",onSearch:t},null,8,["value"]),(0,r.bF)(m,{columns:n,"data-source":s.value},{bodyCell:(0,r.k6)((({column:e,record:a})=>["avatarUrl"===e.dataIndex?((0,r.uX)(),(0,r.Wv)(d,{key:0,src:a.avatarUrl,width:120},null,8,["src"])):"userRole"===e.dataIndex?((0,r.uX)(),(0,r.CE)(r.FK,{key:1},[1===a.role?((0,r.uX)(),(0,r.CE)("div",K,[(0,r.bF)(u,{color:"green"},{default:(0,r.k6)((()=>i[1]||(i[1]=[(0,r.eW)("管理员")]))),_:1})])):((0,r.uX)(),(0,r.CE)("div",W,[(0,r.bF)(u,{color:"blue"},{default:(0,r.k6)((()=>i[2]||(i[2]=[(0,r.eW)("普通用户")]))),_:1})]))],64)):"gender"===e.dataIndex?((0,r.uX)(),(0,r.CE)(r.FK,{key:2},[0===a.gender?((0,r.uX)(),(0,r.CE)("div",D,[(0,r.bF)(u,{color:"blue"},{default:(0,r.k6)((()=>i[3]||(i[3]=[(0,r.eW)("男")]))),_:1})])):1===a.gender?((0,r.uX)(),(0,r.CE)("div",M,[(0,r.bF)(u,{color:"green"},{default:(0,r.k6)((()=>i[4]||(i[4]=[(0,r.eW)("女")]))),_:1})])):((0,r.uX)(),(0,r.CE)("div",O,[(0,r.bF)(u,{color:"gray"},{default:(0,r.k6)((()=>i[5]||(i[5]=[(0,r.eW)("未知")]))),_:1})]))],64)):(0,r.Q3)("",!0),"createTime"===e.dataIndex?((0,r.uX)(),(0,r.CE)(r.FK,{key:3},[(0,r.eW)((0,v.v_)((0,l.R1)(w())(a.createTime).format("YYYY-MM-DD HH:mm:ss")),1)],64)):"action"===e.key?((0,r.uX)(),(0,r.Wv)(p,{key:4,danger:"",onClick:e=>o(a.id)},{default:(0,r.k6)((()=>i[6]||(i[6]=[(0,r.eW)("删除")]))),_:2},1032,["onClick"])):(0,r.Q3)("",!0)])),_:1},8,["data-source"])])}}});const X=q;var $=X;const N={id:"userLoginPage"},G={class:"login-card"};var j=(0,r.pM)({__name:"UserLoginPage",setup(e){const a=(0,c.rd)(),t=na(),o=(0,l.Kh)({userAccount:"",userPassword:""}),n=async e=>{try{console.log("登录请求参数：",e);const o=await Ve(e);console.log("登录接口返回：",o);const r=o.data||o;0===r.code&&r.data?(t.setLoginUser(r.data),i.Ay.success("登录成功"),m(),f(),setTimeout((async()=>{const e=a.currentRoute.value.query.redirect,t=e?decodeURIComponent(e):"/app/components/leader-dashboard";await a.push({path:t,replace:!0}),console.log("登录成功，跳转到目标页面")}),500)):i.Ay.error(r.message||"登录失败：账号或密码错误")}catch(o){i.Ay.error(o.message||"登录异常，请稍后重试"),console.error("登录请求失败：",o)}},s=e=>{console.log("表单验证失败：",e)};return(e,a)=>{const t=(0,r.g2)("a-input"),l=(0,r.g2)("a-form-item"),i=(0,r.g2)("a-input-password"),c=(0,r.g2)("a-button"),d=(0,r.g2)("a-form");return(0,r.uX)(),(0,r.CE)("div",N,[(0,r.Lk)("div",G,[a[3]||(a[3]=(0,r.Lk)("h2",{class:"title"},"用户登录",-1)),(0,r.bF)(d,{model:o,"label-align":"left",name:"basic","label-col":{span:4},"wrapper-col":{span:20},autocomplete:"off",onFinish:n,onFinishFailed:s},{default:(0,r.k6)((()=>[(0,r.bF)(l,{label:"账号",name:"userAccount",rules:[{required:!0,message:"请输入账号！"}]},{default:(0,r.k6)((()=>[(0,r.bF)(t,{value:o.userAccount,"onUpdate:value":a[0]||(a[0]=e=>o.userAccount=e),placeholder:"请输入账号"},null,8,["value"])])),_:1}),(0,r.bF)(l,{label:"密码",name:"userPassword",rules:[{required:!0,message:"请输入密码!"},{min:8,message:"密码不能小于8位"}]},{default:(0,r.k6)((()=>[(0,r.bF)(i,{value:o.userPassword,"onUpdate:value":a[1]||(a[1]=e=>o.userPassword=e),placeholder:"请输入密码"},null,8,["value"])])),_:1}),(0,r.bF)(l,{"wrapper-col":{offset:4,span:20}},{default:(0,r.k6)((()=>[(0,r.bF)(c,{type:"primary","html-type":"submit",block:""},{default:(0,r.k6)((()=>a[2]||(a[2]=[(0,r.eW)("登录")]))),_:1})])),_:1})])),_:1},8,["model"])])])}}});const B=(0,S.A)(j,[["__scopeId","data-v-da9f57ec"]]);var H=B;const V={id:"userRegisterPage"};var J=(0,r.pM)({__name:"UserRegisterPage",setup(e){const a=(0,c.rd)(),t=na(),o=(0,l.Kh)({userAccount:"",userPassword:"",checkPassword:""}),n=async e=>{if(o.userPassword!==o.checkPassword)return void i.Ay.error("二次输入的密码不一致");const r=await He(e);0===r.data.code&&r.data.data?(await t.fetchLoginUser(),i.Ay.success("注册成功"),a.push({path:"/user/login",replace:!0})):i.Ay.error("注册失败"+r.data.description)},s=e=>{console.log("Failed:",e)};return(e,a)=>{const t=(0,r.g2)("a-input"),l=(0,r.g2)("a-form-item"),i=(0,r.g2)("a-input-password"),c=(0,r.g2)("a-button"),d=(0,r.g2)("a-form");return(0,r.uX)(),(0,r.CE)("div",V,[a[4]||(a[4]=(0,r.Lk)("h2",{class:"title"},"用户注册",-1)),(0,r.bF)(d,{style:{"max-width":"480px",margin:"0 auto"},model:o,"label-align":"left",name:"basic","label-col":{span:4},"wrapper-col":{span:20},autocomplete:"off",onFinish:n,onFinishFailed:s},{default:(0,r.k6)((()=>[(0,r.bF)(l,{label:"账号",name:"userAccount",rules:[{required:!0,message:"请输入账号！"}]},{default:(0,r.k6)((()=>[(0,r.bF)(t,{value:o.userAccount,"onUpdate:value":a[0]||(a[0]=e=>o.userAccount=e)},null,8,["value"])])),_:1}),(0,r.bF)(l,{label:"密码",name:"userPassword",rules:[{required:!0,message:"请输入密码!"},{min:8,message:"密码不能小于8位"}]},{default:(0,r.k6)((()=>[(0,r.bF)(i,{value:o.userPassword,"onUpdate:value":a[1]||(a[1]=e=>o.userPassword=e),placeholder:"请输入密码"},null,8,["value"])])),_:1}),(0,r.bF)(l,{label:"确认密码",name:"checkPassword",rules:[{required:!0,message:"请输入确认密码!"},{min:8,message:"确认密码不能小于8位"}]},{default:(0,r.k6)((()=>[(0,r.bF)(i,{value:o.checkPassword,"onUpdate:value":a[2]||(a[2]=e=>o.checkPassword=e),placeholder:"请输入确认密码"},null,8,["value"])])),_:1}),(0,r.bF)(l,{"wrapper-col":{offset:4,span:20}},{default:(0,r.k6)((()=>[(0,r.bF)(c,{type:"primary","html-type":"submit"},{default:(0,r.k6)((()=>a[3]||(a[3]=[(0,r.eW)("注册")]))),_:1})])),_:1})])),_:1},8,["model"])])}}});const Q=J;var Z=Q,ee=t.p+"img/hb.66d72f90.png",ae=t(1229),te=t(8709),oe=t(5046);const re={class:"layout-container"},ne={class:"sidebar"},le={class:"logout-btn"},se={class:"main-content"};var ie=(0,r.pM)({__name:"BasicLayout",setup(e){const a=(0,c.rd)(),t=na(),o=(0,l.KR)([{key:"/app/components/leader-dashboard",label:"数据看板",title:"数据看板",icon:()=>(0,r.h)(ae.A)},{key:"/app/home",label:"报表下载",title:"报表下载",icon:()=>(0,r.h)(te.A)},{key:"/app/components/TableEditable",label:"数据录入",title:"数据录入",icon:()=>(0,r.h)(oe.A)}]),n=({key:e})=>{a.push(e)},s=(0,l.KR)(["/app/home"]);a.afterEach((e=>{s.value=[e.path]}));const d=async()=>{try{await Je({}),"function"===typeof t.clearLoginUser?t.clearLoginUser():t.loginUser={userName:"未登录"},localStorage.removeItem("loginUser"),localStorage.removeItem("token"),u(),i.Ay.success("退出成功"),a.replace({path:"/user/login"})}catch(e){console.error("退出登录接口调用失败：",e),"function"===typeof t.clearLoginUser?t.clearLoginUser():t.loginUser={userName:"未登录"},localStorage.removeItem("loginUser"),localStorage.removeItem("token"),u(),i.Ay.success("已退出登录"),a.replace({path:"/user/login"})}},u=()=>{const e=document.cookie.split(";");for(let a=0;a<e.length;a++){const t=e[a],o=t.indexOf("="),r=o>-1?t.substr(0,o).trim():t.trim();document.cookie=`${r}=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/; domain=${window.location.hostname}`}};return(e,a)=>{const t=(0,r.g2)("a-menu"),l=(0,r.g2)("a-button"),i=(0,r.g2)("router-view");return(0,r.uX)(),(0,r.CE)("div",re,[(0,r.Lk)("aside",ne,[a[2]||(a[2]=(0,r.Lk)("div",{class:"sidebar-header"},[(0,r.Lk)("img",{class:"logo",src:ee,alt:"logo"})],-1)),(0,r.bF)(t,{selectedKeys:s.value,"onUpdate:selectedKeys":a[0]||(a[0]=e=>s.value=e),mode:"vertical",items:o.value,onClick:n,class:"sidebar-menu"},null,8,["selectedKeys","items"]),(0,r.Lk)("div",le,[(0,r.bF)(l,{type:"text",onClick:d},{default:(0,r.k6)((()=>a[1]||(a[1]=[(0,r.eW)("退出登录")]))),_:1})])]),(0,r.Lk)("main",se,[(0,r.bF)(i)])])}}});const ce=(0,S.A)(ie,[["__scopeId","data-v-9b1f59ce"]]);var de=ce,ue=(t(8111),t(7588),t(1701),t(2805)),pe=t(8497);const me=async()=>Be.request({url:"/api/Dashboard/getLineChartOne",method:"GET"}),he=async()=>Be.request({url:"/api/Dashboard/getLineChartTwo",method:"GET"}),fe=async()=>Be.request({url:"/api/Dashboard/getLineChartThree",method:"GET"}),ge=async()=>Be.request({url:"/api/Dashboard/getPieChart",method:"GET"}),ye=async()=>Be.request({url:"/api/Dashboard/getCoreChart",method:"GET"}),ve={id:"leaderDashboardPage"},be={class:"top"},we={class:"production-cards"},xe={class:"refresh-btn-group"},ke={class:"chart-section line-charts-section"},Le={style:{width:"100%",height:"300px"}},Ae={style:{width:"100%",height:"300px"}},Se={style:{width:"100%",height:"300px"}},Fe={class:"chart-section pie-bar-chart-section"},_e={style:{width:"100%",height:"300px"}},Ce={style:{width:"100%",height:"300px"}};var Te=(0,r.pM)({__name:"LeaderDashboard",setup(e){const a=(0,l.KR)(!1),t=(0,l.Kh)({pie:!1,dayLine:!1,weekLine:!1,monthLine:!1,bar:!1}),o=(0,l.Kh)({yesterday:0,week:0,month:0,year:0}),n=(0,l.KR)(null),s=(0,l.KR)(null),c=(0,l.KR)(null),d=(0,l.KR)(null),u=(0,l.KR)(null);let p=null,m=null,h=null,f=null,g=null;const y=(0,l.KR)([]),v=(0,l.KR)({xAxis:[],series:[]}),b=(0,l.KR)({xAxis:[],series:[]}),w=(0,l.KR)({xAxis:[],series:[]}),x=(0,l.KR)({xAxis:[],series:[]}),k=async e=>{try{const e=await ye(),a=e.data;if(0!==a.code)throw new Error(a.message);Object.assign(o,a.data)}catch(a){console.error("获取核心产量数据失败：",a),i.Ay.error("核心产量数据加载失败")}},L=async e=>{try{t.pie=!0;const e=await ge(),a=e.data;if(0!==a.code)throw new Error(a.message);y.value=a.data,await(0,r.dY)(),setTimeout((()=>C("pie")),100)}catch(a){console.error("获取饼图数据失败：",a),i.Ay.error("产量占比图表数据加载失败"),y.value=[{name:"生产线A",value:350},{name:"生产线B",value:280},{name:"生产线C",value:420},{name:"生产线D",value:180}],await(0,r.dY)(),setTimeout((()=>C("pie")),100)}finally{t.pie=!1}},A=async e=>{try{t.dayLine=!0;const e=await me(),a=e.data;if(0!==a.code)throw new Error(a.message||"获取昨日时段产量数据失败");if(!(a.data&&a.data.xAxis&&a.data.series))throw new Error("接口返回数据格式异常");v.value=a.data,await(0,r.dY)(),setTimeout((()=>C("dayLine")),100)}catch(a){console.error("获取日折线图数据失败：",a),i.Ay.error("昨日时段产量趋势图表数据加载失败"),v.value={xAxis:["00:00","04:00","08:00","12:00","16:00","20:00"],series:[{name:"羟基乙腈",data:[85,88,92,89,95,91]}]},await(0,r.dY)(),setTimeout((()=>C("dayLine")),100)}finally{t.dayLine=!1}},S=async e=>{try{t.weekLine=!0;const e=await he(),a=e.data;if(0!==a.code)throw new Error(a.message||"获取周产量数据失败");if(!(a.data&&a.data.xAxis&&a.data.series))throw new Error("接口返回数据格式异常");b.value=a.data,await(0,r.dY)(),setTimeout((()=>C("weekLine")),100)}catch(a){console.error("获取周折线图数据失败：",a),i.Ay.error("周产量趋势图表数据加载失败"),b.value={xAxis:["周一","周二","周三","周四","周五","周六","周日"],series:[{name:"摩尔比",data:[1.2,1.3,1.1,1.4,1.25,1.35,1.28]}]},await(0,r.dY)(),setTimeout((()=>C("weekLine")),100)}finally{t.weekLine=!1}},F=async e=>{try{t.monthLine=!0;const e=await fe(),a=e.data;if(0!==a.code)throw new Error(a.message||"获取月产量数据失败");if(!(a.data&&a.data.xAxis&&a.data.series))throw new Error("接口返回数据格式异常");w.value=a.data,await(0,r.dY)(),setTimeout((()=>C("monthLine")),100)}catch(a){console.error("获取月折线图数据失败：",a),i.Ay.error("月产量趋势图表数据加载失败"),w.value={xAxis:["1日","5日","10日","15日","20日","25日","30日"],series:[{name:"羟基乙腈配料",data:[82,85,88,86,90,89,91]}]},await(0,r.dY)(),setTimeout((()=>C("monthLine")),100)}finally{t.monthLine=!1}},_=async e=>{try{t.bar=!0;const e={xAxis:["批次1","批次2","批次3","批次4","批次5","批次6"],series:[{name:"羟基原料浓度",data:[85.2,88.7,90.1,87.5,92.3,89.8]},{name:"羟基配料浓度",data:[78.5,81.2,83.7,80.9,85.1,82.4]}]};x.value=e,await(0,r.dY)(),setTimeout((()=>C("bar")),100)}catch(a){console.error("获取柱状图数据失败：",a),i.Ay.error("柱状图数据加载失败"),x.value={xAxis:["暂无数据"],series:[{name:"产量",data:[0]}]},await(0,r.dY)(),setTimeout((()=>C("bar")),100)}finally{t.bar=!1}},C=(e="all")=>{if("pie"===e||"all"===e){if(!n.value)return;try{p&&p.dispose(),p=pe.Ts(n.value);const e=y.value.length?y.value:[{name:"暂无数据",value:1}];p.setOption({title:{text:"产量占比",left:"center",top:10,textStyle:{fontSize:16,fontWeight:600,color:"#333"}},color:["#003399","#00AEEF","#0066CC","#66B2FF"],tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} 件 ({d}%)"},legend:{orient:"horizontal",bottom:0,textStyle:{color:"#333"}},toolbox:{show:!0,feature:{saveAsImage:{show:!0,title:"下载图片",type:"png",pixelRatio:2,backgroundColor:"#ffffff"}},right:10,top:10},series:[{name:"产量占比",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,label:{show:!1},emphasis:{label:{show:!0,fontSize:16,fontWeight:600}},labelLine:{show:!1},data:e}]})}catch(a){console.error("初始化饼图失败：",a),p=null}}if("dayLine"===e||"all"===e){if(!s.value)return;try{m&&m.dispose(),m=pe.Ts(s.value);const e=v.value.xAxis.length?v.value.xAxis:["暂无数据"],a=v.value.series.length?v.value.series:[{name:"产量",data:[0]}];m.setOption({title:{text:"昨日羟基乙腈浓度趋势",left:"center",top:10,textStyle:{fontSize:16,fontWeight:600,color:"#333"}},color:["#003399"],tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{orient:"horizontal",top:40,left:"center",textStyle:{color:"#333",fontSize:12}},toolbox:{show:!0,feature:{saveAsImage:{show:!0,title:"下载图片",type:"png",pixelRatio:2,backgroundColor:"#ffffff"}},right:10,top:10},grid:{left:"3%",right:"4%",bottom:"3%",top:"70px",containLabel:!0},xAxis:{type:"category",data:e,axisLine:{lineStyle:{color:"#e8f4fc"}},axisLabel:{color:"#666"}},yAxis:{type:"value",name:"g/L",nameTextStyle:{color:"#003399"},axisLine:{lineStyle:{color:"#e8f4fc"}},axisLabel:{color:"#666"},splitLine:{lineStyle:{color:"#e8f4fc"}},min:e=>Math.floor(e.min),max:e=>Math.ceil(e.max)},series:a.map((e=>({name:e.name,type:"line",smooth:!0,data:e.data,showSymbol:!1,lineStyle:{width:1}})))})}catch(a){console.error("初始化日折线图失败：",a),m=null}}if("weekLine"===e||"all"===e){if(!c.value)return;try{h&&h.dispose(),h=pe.Ts(c.value);const e=b.value.xAxis.length?b.value.xAxis:["暂无数据"],a=b.value.series.length?b.value.series:[{name:"产量",data:[0]}];h.setOption({title:{text:"本周摩尔比趋势",left:"center",top:10,textStyle:{fontSize:16,fontWeight:600,color:"#333"}},color:["#003399"],tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{orient:"horizontal",top:40,left:"center",textStyle:{color:"#333",fontSize:12}},toolbox:{show:!0,feature:{saveAsImage:{show:!0,title:"下载图片",type:"png",pixelRatio:2,backgroundColor:"#ffffff"}},right:10,top:10},grid:{left:"3%",right:"4%",bottom:"3%",top:"70px",containLabel:!0},xAxis:{type:"category",data:e,axisLine:{lineStyle:{color:"#e8f4fc"}},axisLabel:{color:"#666"}},yAxis:{type:"value",name:"-",nameTextStyle:{color:"#003399"},axisLine:{lineStyle:{color:"#e8f4fc"}},axisLabel:{color:"#666"},splitLine:{lineStyle:{color:"#e8f4fc"}},min:e=>Math.floor(e.min),max:e=>Math.ceil(e.max)},series:a.map((e=>({name:e.name,type:"line",smooth:!0,data:e.data,showSymbol:!1,lineStyle:{width:1}})))})}catch(a){console.error("初始化周折线图失败：",a),h=null}}if("monthLine"===e||"all"===e){if(!d.value)return;try{f&&f.dispose(),f=pe.Ts(d.value);const e=w.value.xAxis.length?w.value.xAxis:["暂无数据"],a=w.value.series.length?w.value.series:[{name:"产量",data:[0]}];f.setOption({title:{text:"本月羟基乙腈配料浓度趋势",left:"center",top:10,textStyle:{fontSize:16,fontWeight:600,color:"#333"}},color:["#003399"],tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{orient:"horizontal",top:40,left:"center",textStyle:{color:"#333",fontSize:12}},toolbox:{show:!0,feature:{saveAsImage:{show:!0,title:"下载图片",type:"png",pixelRatio:2,backgroundColor:"#ffffff"}},right:10,top:10},grid:{left:"3%",right:"4%",bottom:"3%",top:"70px",containLabel:!0},xAxis:{type:"category",data:e,axisLine:{lineStyle:{color:"#e8f4fc"}},axisLabel:{color:"#666"}},yAxis:{type:"value",name:"g/L",nameTextStyle:{color:"#003399"},axisLine:{lineStyle:{color:"#e8f4fc"}},axisLabel:{color:"#666"},splitLine:{lineStyle:{color:"#e8f4fc"}},min:e=>Math.floor(e.min),max:e=>Math.ceil(e.max)},series:a.map((e=>({name:e.name,type:"line",smooth:!0,data:e.data,showSymbol:!1,lineStyle:{width:1}})))})}catch(a){console.error("初始化月折线图失败：",a),f=null}}if("bar"===e||"all"===e){if(!u.value)return;try{g&&g.dispose(),g=pe.Ts(u.value);const e=x.value.xAxis.length?x.value.xAxis:["暂无数据"],a=x.value.series.length?x.value.series:[{name:"产量",data:[0]}],t=[{normal:new pe.fA.W4(0,0,0,1,[{offset:0,color:"#0066CC"},{offset:1,color:"#003399"}]),hover:new pe.fA.W4(0,0,0,1,[{offset:0,color:"#3399FF"},{offset:1,color:"#0066CC"}]),border:"#002288"},{normal:new pe.fA.W4(0,0,0,1,[{offset:0,color:"#66B2FF"},{offset:1,color:"#00AEEF"}]),hover:new pe.fA.W4(0,0,0,1,[{offset:0,color:"#99CCFF"},{offset:1,color:"#66B2FF"}]),border:"#0099DD"}];g.setOption({title:{text:"各批次浓度对比",left:"center",top:10,textStyle:{fontSize:16,fontWeight:600,color:"#333"}},color:[t[0].normal,t[1].normal],tooltip:{trigger:"axis",axisPointer:{type:"shadow"},textStyle:{fontSize:12},backgroundColor:"rgba(255,255,255,0.9)",borderColor:"#e8f4fc",borderWidth:1,padding:10,formatter:function(e){let a=`<div style="font-weight:600;margin-bottom:5px">${e[0].axisValue}</div>`;return e.forEach((e=>{a+=`<div style="margin:3px 0">\n                <span style="display:inline-block;width:8px;height:8px;background:${e.color};margin-right:5px;border-radius:2px;"></span>\n                ${e.seriesName}：<span style="font-weight:600">${e.value} g/L</span>\n              </div>`})),a}},legend:{orient:"horizontal",top:40,left:"center",textStyle:{color:"#333",fontSize:12},icon:"rect",itemWidth:12,itemHeight:8,itemGap:20},toolbox:{show:!0,feature:{saveAsImage:{show:!0,title:"下载图片",type:"png",pixelRatio:2,backgroundColor:"#ffffff"}},right:10,top:10},grid:{left:"3%",right:"4%",bottom:"3%",top:"70px",containLabel:!0},xAxis:{type:"category",data:e,axisLine:{lineStyle:{color:"#e8f4fc"}},axisLabel:{color:"#666",fontSize:11,interval:0,rotate:0},axisTick:{alignWithLabel:!0}},yAxis:{type:"value",name:"g/L",nameTextStyle:{color:"#0066CC",fontSize:12},axisLine:{lineStyle:{color:"#e8f4fc"}},axisLabel:{color:"#666",fontSize:11},splitLine:{lineStyle:{color:"#e8f4fc",type:"dashed"}},min:e=>Math.floor(e.min),max:e=>Math.ceil(e.max)},series:a.map(((e,a)=>({name:e.name,type:"bar",barWidth:"35%",barGap:"30%",barCategoryGap:"40%",data:e.data,itemStyle:{color:t[a].normal,borderRadius:[4,4,0,0],borderWidth:1,borderColor:t[a].border,borderType:"solid"},emphasis:{itemStyle:{color:t[a].hover,borderWidth:1.5,shadowBlur:6,shadowColor:"rgba(0, 102, 204, 0.2)",shadowOffsetY:2},label:{show:!0,position:"top",fontSize:11,fontWeight:600,color:"#333",formatter:"{c} g/L"}},label:{show:!1}})))})}catch(a){console.error("初始化柱状图失败：",a),g=null}}},T=async()=>{try{a.value=!0;const e={};await k(e),await Promise.all([L(e),A(e),S(e),F(e),_(e)]),i.Ay.success("数据刷新请求已发送"),setTimeout((()=>{C("all")}),500)}catch(e){console.error("获取核心数据失败：",e),i.Ay.error("核心数据加载失败，请稍后重试")}finally{setTimeout((()=>{a.value=!1}),600)}};return(0,r.sV)((async()=>{await T();const e=()=>{p&&p.resize(),m&&m.resize(),h&&h.resize(),f&&f.resize(),g&&g.resize()};window.addEventListener("resize",e),(0,r.hi)((()=>{window.removeEventListener("resize",e),p&&p.dispose(),m&&m.dispose(),h&&h.dispose(),f&&f.dispose(),g&&g.dispose()}))})),(e,i)=>{const p=(0,r.g2)("a-statistic"),m=(0,r.g2)("a-card"),h=(0,r.g2)("a-button");return(0,r.uX)(),(0,r.CE)("div",ve,[(0,r.Lk)("div",be,[(0,r.Lk)("div",we,[(0,r.bF)(m,{class:"production-card",loading:a.value,hoverable:""},{default:(0,r.k6)((()=>[(0,r.bF)(p,{title:"昨日羟基原料浓度",value:o.yesterday,precision:2,suffix:"g/L",class:"stat-item"},{prefix:(0,r.k6)((()=>[(0,r.bF)((0,l.R1)(ue.A),{class:"stat-icon"})])),_:1},8,["value"])])),_:1},8,["loading"]),(0,r.bF)(m,{class:"production-card",loading:a.value,hoverable:""},{default:(0,r.k6)((()=>[(0,r.bF)(p,{title:"昨日羟基配料浓度",value:o.week,precision:2,suffix:"g/L",class:"stat-item"},{prefix:(0,r.k6)((()=>[(0,r.bF)((0,l.R1)(ue.A),{class:"stat-icon"})])),_:1},8,["value"])])),_:1},8,["loading"]),(0,r.bF)(m,{class:"production-card",loading:a.value,hoverable:""},{default:(0,r.k6)((()=>[(0,r.bF)(p,{title:"昨日摩尔比",value:o.month,precision:2,suffix:" ",class:"stat-item"},{prefix:(0,r.k6)((()=>[(0,r.bF)((0,l.R1)(ue.A),{class:"stat-icon"})])),_:1},8,["value"])])),_:1},8,["loading"]),(0,r.bF)(m,{class:"production-card",loading:a.value,hoverable:""},{default:(0,r.k6)((()=>[(0,r.bF)(p,{title:"昨日累计配比",value:o.year,precision:2,suffix:" ",class:"stat-item"},{prefix:(0,r.k6)((()=>[(0,r.bF)((0,l.R1)(ue.A),{class:"stat-icon"})])),_:1},8,["value"])])),_:1},8,["loading"])]),(0,r.Lk)("div",xe,[(0,r.bF)(h,{type:"primary",onClick:T,loading:a.value},{default:(0,r.k6)((()=>i[0]||(i[0]=[(0,r.eW)("刷新")]))),_:1},8,["loading"])])]),(0,r.Lk)("div",ke,[(0,r.bF)(m,{class:"chart-card line-chart-card",loading:t.dayLine,"body-style":{padding:"5px"}},{default:(0,r.k6)((()=>[(0,r.Lk)("div",Le,[(0,r.Lk)("div",{ref_key:"dayLineChartRef",ref:s,class:"chart-container"},null,512)])])),_:1},8,["loading"]),(0,r.bF)(m,{class:"chart-card line-chart-card",loading:t.weekLine,"body-style":{padding:"5px"}},{default:(0,r.k6)((()=>[(0,r.Lk)("div",Ae,[(0,r.Lk)("div",{ref_key:"weekLineChartRef",ref:c,class:"chart-container"},null,512)])])),_:1},8,["loading"]),(0,r.bF)(m,{class:"chart-card line-chart-card",loading:t.monthLine,"body-style":{padding:"5px"}},{default:(0,r.k6)((()=>[(0,r.Lk)("div",Se,[(0,r.Lk)("div",{ref_key:"monthLineChartRef",ref:d,class:"chart-container"},null,512)])])),_:1},8,["loading"])]),(0,r.Lk)("div",Fe,[(0,r.bF)(m,{class:"chart-card",loading:t.pie},{default:(0,r.k6)((()=>[(0,r.Lk)("div",_e,[(0,r.Lk)("div",{ref_key:"pieChartRef",ref:n,class:"chart-container"},null,512)])])),_:1},8,["loading"]),(0,r.bF)(m,{class:"chart-card",loading:t.bar},{default:(0,r.k6)((()=>[(0,r.Lk)("div",Ce,[(0,r.Lk)("div",{ref_key:"barChartRef",ref:u,class:"chart-container"},null,512)])])),_:1},8,["loading"])])])}}});const Re=(0,S.A)(Te,[["__scopeId","data-v-65600364"]]);var Ee=Re,Ue=(t(2489),t(116),t(1219));const Ie=async()=>Be.request({url:"/api/ReportRecord/Headers",method:"GET"}),ze=async e=>Be.request({url:"/api/ReportRecord/HourData",method:"GET",params:e}),Ye=async e=>Be.request({url:"api/ReportRecord/SaveCell",method:"POST",data:e}),Pe=async e=>Be.request({url:"api/Report/BuildReport",method:"POST",data:e}),Ke={class:"table-container"},We={class:"date-selector"},De={class:"table-scroll-wrapper"};var Me=(0,r.pM)({__name:"TableEditable",setup(e){const a=(0,l.KR)(""),t=(0,l.KR)([]),o=(0,l.KR)([]),n=(0,l.KR)(window.innerWidth),s=(0,l.KR)(window.innerHeight),i=()=>{n.value=window.innerWidth,s.value=window.innerHeight,(0,r.dY)((()=>{document.documentElement.style.overflowY="hidden"}))},c=(0,r.EW)((()=>n.value<1366?"small":n.value<1920?"normal":"large")),d=()=>"small"===c.value?"small":"default",u=()=>"small"===c.value?8:16,p=()=>{const e={flexShrink:"0",padding:"0 4px"};switch(c.value){case"small":e.width="180px";break;case"normal":e.width="200px";break;case"large":e.width="220px";break}return e},m=e=>"hour"===e?"small"===c.value?50:60:"small"===c.value?80:"large"===c.value?100:90,h=()=>{const e="small"===c.value?"11px":"large"===c.value?"13px":"12px";return{fontSize:e,padding:"2px 0"}},f=()=>{const e="small"===c.value?"10px":"large"===c.value?"14px":"13px";return{fontSize:e,padding:"2px 0"}},g=()=>"small"===c.value?"12px":"large"===c.value?"14px":"13px",y=e=>{const a=new Date;a.setHours(0,0,0,0);const t=new Date(e);return t.setHours(0,0,0,0),t.getTime()>a.getTime()},b=e=>!e.date||void 0===e.hour||null===e.hour||!0===e.isNextDay,w=({row:e,column:a})=>"hour"===a.prop||b(e)?"disabled-cell":"",x=async()=>{try{const e=await Ie();if(e?.data){t.value=e.data;const a=t.value.find((e=>"hour"===e.prop));a&&(t.value=[a,...t.value.filter((e=>"hour"!==e.prop))])}}catch(e){Ue.nk.error("获取表格表头失败，请刷新页面"),console.error("fetchTableHeaders error:",e)}},k=async()=>{if(a.value)try{const e=await ze({date:a.value}),t=e?.data||[];if(0===t.length)return o.value=[],void Ue.nk.info(`【${a.value}】暂无小时数据`);const r=t.map((e=>{if(!e)return{hour:0,date:a.value,isNextDay:!1,cells:{}};const t=e.cells||{};return{...e,...t}}));o.value=r,Ue.nk.success(`【${a.value}】小时数据加载成功`)}catch(e){Ue.nk.error("小时数据加载失败，请重试"),console.error("fetchTableData error:",e)}else Ue.nk.warning("请先选择查询日期")},L=async(e,a)=>{if("hour"===a||b(e))return;const t={date:e.date,hour:e.hour,prop:a,value:e[a]||""};try{await Ye(t),Ue.nk.success(`已保存：${e.date} ${e.hour}点 - ${a} 字段`)}catch(o){Ue.nk.error("单元格数据保存失败，请重试"),console.error("handleCellEdit error:",o)}},A=async()=>{if(a.value)try{Ue.nk.info(`正在重载【${a.value}】数据，请稍候...`);const e=new Date(a.value);e.setDate(e.getDate()+1);const t={type:1,time:e.toISOString().split("T")[0]};await Pe(t),await k(),Ue.nk.success(`【${a.value}】数据重载完成`)}catch(e){Ue.nk.error("数据重载失败，请重试"),console.error("reloadTableData error:",e)}else Ue.nk.warning("请先选择查询日期")};return(0,r.sV)((async()=>{window.addEventListener("resize",i),await x(),a.value=(new Date).toISOString().split("T")[0],await k(),(0,r.dY)((()=>{document.documentElement.style.overflowY="hidden",document.body.style.overflowY="hidden"}))})),(0,r.hi)((()=>{window.removeEventListener("resize",i),document.documentElement.style.overflowY="auto",document.body.style.overflowY="auto"})),(e,n)=>{const l=(0,r.g2)("el-date-picker"),s=(0,r.g2)("el-button"),i=(0,r.g2)("el-input"),c=(0,r.g2)("el-table-column"),x=(0,r.g2)("el-table"),S=(0,r.g2)("a-tab-pane"),F=(0,r.g2)("a-tabs");return(0,r.uX)(),(0,r.Wv)(F,{type:"card",style:{maxWidth:"100%",margin:"20px auto",padding:"0 10px"},"tab-bar-gutter":u()},{default:(0,r.k6)((()=>[(0,r.bF)(S,{key:"data-edit",tab:"检测数据"},{default:(0,r.k6)((()=>[(0,r.Lk)("div",Ke,[(0,r.Lk)("div",We,[(0,r.bF)(l,{modelValue:a.value,"onUpdate:modelValue":n[0]||(n[0]=e=>a.value=e),type:"date",placeholder:"选择查询日期",onChange:k,format:"YYYY-MM-DD","value-format":"YYYY-MM-DD","disabled-date":y,"picker-options":{shortcuts:[{text:"今天",onClick:()=>{a.value.value=(new Date).toISOString().split("T")[0],k()}}]},size:d(),style:(0,v.Tr)(p())},null,8,["modelValue","picker-options","size","style"]),(0,r.bF)(s,{type:"primary",onClick:k,size:d()},{default:(0,r.k6)((()=>n[1]||(n[1]=[(0,r.eW)(" 查询 ")]))),_:1},8,["size"]),(0,r.bF)(s,{type:"primary",onClick:A,size:d()},{default:(0,r.k6)((()=>n[2]||(n[2]=[(0,r.eW)(" 重载 ")]))),_:1},8,["size"])]),(0,r.Lk)("div",De,[(0,r.bF)(x,{data:o.value,border:"",style:{width:"100%","table-layout":"fixed"},"cell-class-name":w,size:d(),"empty-text":"当前日期暂无小时数据","header-cell-style":h(),"cell-style":f(),height:"100%","header-row-class-name":"fixed-table-header"},{default:(0,r.k6)((()=>[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(t.value,((e,a)=>((0,r.uX)(),(0,r.Wv)(c,{key:a,prop:e.prop,label:e.label,width:m(e.prop),align:"center","show-overflow-tooltip":!0,fixed:"hour"===e.prop&&"left"},{default:(0,r.k6)((a=>["hour"===e.prop?((0,r.uX)(),(0,r.CE)(r.FK,{key:0},[(0,r.eW)((0,v.v_)(a.row[e.prop]),1)],64)):((0,r.uX)(),(0,r.CE)(r.FK,{key:1},[b(a.row)?((0,r.uX)(),(0,r.CE)(r.FK,{key:0},[(0,r.eW)((0,v.v_)(a.row[e.prop]||"-"),1)],64)):((0,r.uX)(),(0,r.Wv)(i,{key:1,modelValue:a.row[e.prop],"onUpdate:modelValue":t=>a.row[e.prop]=t,size:d(),onBlur:t=>L(a.row,e.prop),disabled:b(a.row),maxlength:"8",style:{width:"100%",height:"100%"}},null,8,["modelValue","onUpdate:modelValue","size","onBlur","disabled"]))],64))])),_:2},1032,["prop","label","width","fixed"])))),128))])),_:1},8,["data","size","header-cell-style","cell-style"])])])])),_:1}),(0,r.bF)(S,{key:"data-view",tab:"数据预览"},{default:(0,r.k6)((()=>[(0,r.Lk)("div",{style:(0,v.Tr)([{padding:"20px","text-align":"center"},{fontSize:g()}])}," 数据预览模块（可自定义内容） ",4)])),_:1})])),_:1},8,["tab-bar-gutter"])}}});const Oe=(0,S.A)(Me,[["__scopeId","data-v-f1c18226"]]);var qe=Oe;const Xe=[{path:"/",redirect:"/user/login"},{path:"/user/login",name:"userLogin",component:H,meta:{requiresAuth:!1}},{path:"/user/register",name:"userRegister",component:Z,meta:{requiresAuth:!1}},{path:"/app",component:de,meta:{requiresAuth:!0},children:[{path:"home",name:"homePage",component:Y},{path:"admin/userManage",name:"adminUserManage",component:$},{path:"components/leader-dashboard",name:"LeaderDashboard",component:Ee,meta:{title:"数据看板"}},{path:"components/TableEditable",name:"TableEditable",component:qe,meta:{title:"手动填写"}}]},{path:"/:pathMatch(.*)*",redirect:"/user/login"}],$e=(0,c.aE)({history:(0,c.LA)("/"),routes:Xe});$e.beforeEach(((e,a,t)=>{const o=na();o.restoreLoginUser();const r=!!o.loginUser.id;if(r&&h())return i.Ay.warning("登录状态已超时，请重新登录"),o.clearLoginUser(),void t({path:"/user/login",query:{redirect:encodeURIComponent(e.fullPath)}});e.meta.requiresAuth?r?t():(i.Ay.warning("请先登录后再访问"),t({path:"/user/login",query:{redirect:encodeURIComponent(e.fullPath)}})):!r||"/user/login"!==e.path&&"/user/register"!==e.path?t():t("/app/home")}));var Ne=$e;let Ge=!1;const je=s.A.create({baseURL:window.location.origin,timeout:1e4,withCredentials:!0});je.interceptors.request.use((function(e){e.headers["Content-Type"]||(e.headers["Content-Type"]="application/json;charset=UTF-8");const a=na();return a.loginUser.token&&(e.headers.Authorization=`Bearer ${a.loginUser.token}`),e}),(function(e){return i.Ay.error("请求配置异常，请检查参数或网络设置"),console.error("请求拦截器错误：",e),Promise.reject(e)})),je.interceptors.response.use((function(e){const a=na();if(a.loginUser.id&&h())return g(),e;if("blob"===e.config.responseType){let a="导出文件.xlsx";if(e.headers["content-disposition"]||e.headers["Content-Disposition"])try{const t=e.headers["content-disposition"]||e.headers["Content-Disposition"];a=decodeURI(t.split("filename=")[1]),a=a.replace(/"/g,"")}catch(o){a="导出文件.xlsx"}return e.fileBlobData=e.data,e.fileDownloadName=a,e}const{data:t}=e;if(console.log("响应数据：",t),40100===t.code){const a=e.request.responseURL.includes("user/current"),t=Ne.currentRoute.value.path.includes("/user/login");if(!a&&!t&&!Ge){Ge=!0,i.Ay.warning("登录状态已过期，请重新登录");const e=na();e.clearLoginUser(),Ne.push({path:"/user/login",query:{redirect:encodeURIComponent(Ne.currentRoute.value.fullPath)}}).finally((()=>{Ge=!1}))}}return t.code&&0!==t.code&&40100!==t.code&&i.Ay.error(t.message||`请求失败（错误码：${t.code}）`),e}),(function(e){if(e.response){const a=e.response.status;if(401!==a||Ge)401!==a&&i.Ay.error(`请求失败（HTTP状态码：${a}）`);else{const e=Ne.currentRoute.value.path.includes("/user/login");if(!e){Ge=!0,i.Ay.warning("登录状态已过期，请重新登录");const e=na();e.setLoginUser({id:""}),localStorage.removeItem("loginUser"),Ne.push({path:"/user/login",query:{redirect:encodeURIComponent(Ne.currentRoute.value.fullPath)}}).finally((()=>{Ge=!1}))}}}else e.request?i.Ay.error("网络异常，请检查网络连接"):i.Ay.error("请求配置失败："+e.message);return console.error("响应拦截器错误：",e),Promise.reject(e)}));var Be=je;const He=async e=>Be.request({url:"api/user/register",method:"POST",data:e}),Ve=async e=>Be.request({url:"api/user/login",method:"POST",data:e}),Je=async e=>Be.request({url:"api/user/logout",method:"POST",data:e}),Qe=async()=>Be.request({url:"api/user/current",method:"GET"}),Ze=async e=>Be.request({url:"api/user/search",method:"GET",params:{userName:e}}),ea=async e=>Be.request({url:"api/user/delete",method:"POST",data:e,headers:{"Content-Type":"application/json"}}),aa=async e=>Be.request({url:"/api/ReportRecord/GetReportByPage",method:"GET",params:e}),ta=async(e,a)=>Be.request({url:"api/Report/DownloadExcel",method:"GET",params:{timeStr:e,Type:a},responseType:"blob",timeout:6e4}),oa=async e=>Be.request({url:"/api/File/ZipDownloadFile",method:"GET",params:e,responseType:"blob",timeout:12e4}),ra=async e=>Be.request({url:"/api/Report/BuildReport",method:"POST",data:e}),na=(0,n.nY)("loginUser",(()=>{const e=()=>{const e=sessionStorage.getItem("loginUser");if(e)try{return JSON.parse(e)}catch(a){return console.error("sessionStorage用户信息解析失败：",a),{userName:"未登录"}}return{userName:"未登录"}},a=(0,l.KR)(e());async function t(){try{const e=await Qe();0===e.data.code&&e.data.data&&(console.log("接口获取用户信息：",e.data.data),a.value=e.data.data,sessionStorage.setItem("loginUser",JSON.stringify(e.data.data)))}catch(e){console.error("获取当前用户信息失败：",e)}}function o(e){a.value=e,e.id?sessionStorage.setItem("loginUser",JSON.stringify(e)):sessionStorage.removeItem("loginUser")}function r(){a.value={userName:"未登录"},sessionStorage.removeItem("loginUser")}function n(){const e=sessionStorage.getItem("loginUser");if(e)try{a.value=JSON.parse(e)}catch(t){console.error("恢复登录状态失败：",t),r()}}return{loginUser:a,setLoginUser:o,fetchLoginUser:t,clearLoginUser:r,restoreLoginUser:n}})),la={id:"app"};var sa=(0,r.pM)({__name:"App",setup(e){const a=na();return(0,r.sV)((()=>{a.restoreLoginUser(),a.loginUser.id&&h()&&g(),m(),y(),f()})),(e,a)=>{const t=(0,r.g2)("router-view");return(0,r.uX)(),(0,r.CE)("div",la,[(0,r.bF)(t)])}}});const ia=sa;var ca=ia,da=t(9967),ua=(t(4529),t(101)),pa=(t(4188),t(5186));const ma=(0,o.Ef)(ca);ma.use(ua.A,{locale:pa.A}),ma.use((0,n.Ey)()),ma.use(Ne),ma.use(da.Ay),ma.use(ua.A),window.addEventListener("unhandledrejection",(e=>{e.preventDefault();const a=e.reason;401!==a?.response?.status&&40100!==a?.response?.data?.code?(i.Ay.error("系统异常，请稍后重试"),console.error("全局捕获未处理的Promise错误：",a)):console.info("401错误已在axios拦截器中处理，无需重复提示",a)})),ma.use(da.Ay);const ha=na();ha.restoreLoginUser();const fa=window.ResizeObserver;window.ResizeObserver=class extends fa{constructor(e){super(((a,t)=>{requestAnimationFrame((()=>{e(a,t)}))}))}},ma.mount("#app")}},a={};function t(o){var r=a[o];if(void 0!==r)return r.exports;var n=a[o]={exports:{}};return e[o].call(n.exports,n,n.exports,t),n.exports}t.m=e,function(){var e=[];t.O=function(a,o,r,n){if(!o){var l=1/0;for(d=0;d<e.length;d++){o=e[d][0],r=e[d][1],n=e[d][2];for(var s=!0,i=0;i<o.length;i++)(!1&n||l>=n)&&Object.keys(t.O).every((function(e){return t.O[e](o[i])}))?o.splice(i--,1):(s=!1,n<l&&(l=n));if(s){e.splice(d--,1);var c=r();void 0!==c&&(a=c)}}return a}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[o,r,n]}}(),function(){t.n=function(e){var a=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(a,{a:a}),a}}(),function(){t.d=function(e,a){for(var o in a)t.o(a,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:a[o]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)}}(),function(){t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){t.p="/"}(),function(){var e={524:0};t.O.j=function(a){return 0===e[a]};var a=function(a,o){var r,n,l=o[0],s=o[1],i=o[2],c=0;if(l.some((function(a){return 0!==e[a]}))){for(r in s)t.o(s,r)&&(t.m[r]=s[r]);if(i)var d=i(t)}for(a&&a(o);c<l.length;c++)n=l[c],t.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return t.O(d)},o=self["webpackChunkuser_center_frontend_vue"]=self["webpackChunkuser_center_frontend_vue"]||[];o.forEach(a.bind(null,0)),o.push=a.bind(null,o.push.bind(o))}();var o=t.O(void 0,[504],(function(){return t(9274)}));o=t.O(o)})();
//# sourceMappingURL=app.3c1af35b.js.map